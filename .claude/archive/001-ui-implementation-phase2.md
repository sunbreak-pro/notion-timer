---
Completed: 2026-02-07
---

# Sonic Flow - UI-First Implementation Plan

## Context

Phase 1（タスクCRUD + Notion風レイアウト）は完了済み。Phase 2として、UI-Firstアプローチで全画面を構築し、その後バックエンドを統合する。現在のフラットなタスクリストを階層構造に刷新し、タイマー+環境音ミキサーを統合した「作業画面」を新設する。

---

## 確定要件

| 項目 | 決定内容 |
|------|----------|
| サイドバー | **Tasks / Session / Settings** の3項目のみ |
| タスク構造 | **3階層**: フォルダ → サブフォルダ → タスク（VSCode風ツリー） |
| ドラッグ&ドロップ | フォルダ間移動・並び替え対応 |
| 作業画面 | **オーバーレイ表示**（Play押下で起動） |
| 作業画面の内容 | タイマー中央 + 環境音BGMバー下部（YouTube風） |
| Focus Mode | **廃止** → 作業画面に統合 |
| ダークモード | **最初から対応** |
| 環境音 | 自然音6種（Rain, Thunder, Wind, Ocean, Birds, Fire） |
| ミキサーUI | **カードグリッド** |
| Settings | ダークモード / フォントサイズ(S/M/L) / ゴミ箱復元 |
| Trash | サイドバーから**削除**、Settings内で復元 |

---

## サイドバー各セクションの仕様

### Tasks セクション
**メインコンテンツに表示される内容:**
- VSCode風の階層ツリービュー
  - フォルダ（ルートレベルのみ）: 展開/折りたたみ、配下にサブフォルダまたはタスクを持つ
  - サブフォルダ（フォルダ内のみ）: 展開/折りたたみ、配下にタスクを持つ
  - タスク（フォルダまたはサブフォルダ内）: チェックボックス、インライン編集、Playボタン、削除
- ドラッグ&ドロップで並び替え・移動
- 「+ New Folder」ボタン（ルートレベルにフォルダ追加）
- 完了済みタスクの折りたたみセクション

**タスクのPlayボタン:**
- クリックすると**作業画面オーバーレイ**が起動
- オーバーレイにはタスク名が表示される

### Session セクション
**メインコンテンツに表示される内容:**
- タイマー＋環境音ミキサーを**メインコンテンツ内**に表示（タスク非紐付けのフリーセッション）
- Playボタンからの起動とは異なり、特定タスクに紐付かない独立した作業セッション
- レイアウトは作業画面オーバーレイと同一構成（タイマー中央 + BGMバー下部）

### Settings セクション
**メインコンテンツに表示される内容:**
- **外観**: ダークモード切替トグル
- **外観**: フォントサイズ選択（Small / Medium / Large）
- **ゴミ箱**: 削除済みアイテム一覧 + 復元ボタン

---

## 作業画面（Work Screen）の詳細仕様

### 起動方法
1. **タスクのPlayボタン** → オーバーレイモード（タスク名表示、`fixed inset-0 z-50`）
2. **Session サイドバー** → メインコンテンツモード（タスク非紐付け）

### タイマー仕様
- 25分作業 → 5分休憩 → ... → 4セッション後に15分長休憩
- Start / Pause / Reset コントロール
- セッションタイプ表示: WORK / BREAK / LONG_BREAK
- プログレスバー: 経過時間を%で表示（4px高さ、アクセントカラー）

### サウンドカード仕様
- 6枚のカード: Rain, Thunder, Wind, Ocean, Birds, Fire
- 各カード: Lucideアイコン + 名前 + ON/OFFトグル + 音量スライダー(0-100)
- 3列 x 2行のグリッドレイアウト
- UI-First段階ではオーディオ再生なし（状態管理のみ）

---

## 実装フェーズ

### Phase 2-1: ダークモード基盤
### Phase 2-2: サイドバー再構成
### Phase 2-3: 階層タスクツリー
### Phase 2-4: 作業画面（Work Screen）
### Phase 2-5: Settings画面

全フェーズ完了。詳細は各フェーズの実装コードを参照。

---

## 新規依存パッケージ

| パッケージ | 用途 | Phase |
|------------|------|-------|
| `@dnd-kit/core` | D&D基盤 | 2-3 |
| `@dnd-kit/sortable` | ソート対応 | 2-3 |
| `@dnd-kit/utilities` | CSSユーティリティ | 2-3 |
